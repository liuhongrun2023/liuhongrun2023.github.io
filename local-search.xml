<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>pdf转word程序2.0</title>
    <link href="/2023/01/15/pdf%E8%BD%ACword%E7%A8%8B%E5%BA%8F2-0/"/>
    <url>/2023/01/15/pdf%E8%BD%ACword%E7%A8%8B%E5%BA%8F2-0/</url>
    
    <content type="html"><![CDATA[<p><strong>准备工作</strong></p><p><strong>所需要的库:</strong><br><strong>ttkbootstrap</strong><br><strong>安装:</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">pip install ttkbootstrap<br></code></pre></td></tr></table></figure><p><strong>pdf2docx</strong><br><strong>安装:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install pdf2docx<br></code></pre></td></tr></table></figure><p><strong>docx2pdf</strong><br><strong>安装:</strong></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">pip <span class="hljs-keyword">install</span> docx2pdf<br></code></pre></td></tr></table></figure><p><strong>PS:此程序不能用pyinstaller直接打包</strong><br><strong>应在打包时加上</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">--collect-all ttkbootstrap<br></code></pre></td></tr></table></figure><p><strong>比如</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pyinstaller test.py -F -w --collect-all ttkbootstrap<br></code></pre></td></tr></table></figure><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> tkinter.filedialog <span class="hljs-keyword">as</span> tf<br><span class="hljs-keyword">import</span> ttkbootstrap <span class="hljs-keyword">as</span> ttk<br><span class="hljs-keyword">from</span> ttkbootstrap.constants <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ttkbootstrap.dialogs <span class="hljs-keyword">import</span> Messagebox <span class="hljs-keyword">as</span> msgbox<br><span class="hljs-keyword">from</span> pdf2docx <span class="hljs-keyword">import</span> Converter<br><span class="hljs-keyword">from</span> docx2pdf <span class="hljs-keyword">import</span> convert<br><span class="hljs-keyword">import</span> os<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_to_words</span>():<br>    folder = tf.askdirectory(title=<span class="hljs-string">&#x27;选择文件夹&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> os.listdir(folder):<br>            suff_name = os.path.splitext(file)[<span class="hljs-number">1</span>] <span class="hljs-comment"># 分离出扩展名</span><br>            <span class="hljs-keyword">if</span> suff_name != <span class="hljs-string">&#x27;.pdf&#x27;</span>: <span class="hljs-comment"># 如果不是PDF文档就退出</span><br>                <span class="hljs-keyword">continue</span><br>            file_name = os.path.splitext(file)[<span class="hljs-number">0</span>] <span class="hljs-comment"># 分离出文件名</span><br>            pdf_file = folder + <span class="hljs-string">&#x27;\\&#x27;</span> + file<br>            word_file = folder + <span class="hljs-string">&#x27;\\&#x27;</span> + file_name + <span class="hljs-string">&#x27;.docx&#x27;</span> <span class="hljs-comment"># 进行转义并加上扩展名</span><br>            cv = Converter(pdf_file) <span class="hljs-comment"># 转成Word</span><br>            cv.convert(word_file)<br>            cv.close()<br>        msgbox.show_info(<span class="hljs-string">&#x27;转换成功!&#x27;</span>)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        msgbox.show_error(<span class="hljs-string">&#x27;你没有选择任何文件夹!&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_to_word</span>():<br>    <span class="hljs-keyword">try</span>:<br>        pdffile = tf.askopenfilename(title=<span class="hljs-string">&#x27;选择PDF文档&#x27;</span>) <span class="hljs-comment"># 选择文件</span><br>        wordfile = os.path.splitext(pdffile)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.docx&#x27;</span><br>        cv = Converter(pdffile)<br>        cv.convert(wordfile)<br>        cv.close()<br>        msgbox.show_info(<span class="hljs-string">&#x27;转换成功!&#x27;</span>)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        msgbox.show_error(<span class="hljs-string">&#x27;你没有选择任何文件!&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">word_to_pdf</span>():<br>    <span class="hljs-keyword">try</span>:<br>        inputfile = tf.askopenfilename(title=<span class="hljs-string">&#x27;选择docx文档&#x27;</span>)<br>        outputfile = os.path.splitext(inputfile)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.pdf&#x27;</span><br>        f1 = <span class="hljs-built_in">open</span>(outputfile, <span class="hljs-string">&#x27;w&#x27;</span>)<br>        f1.close()<br>        convert(inputfile, outputfile)<br>        msgbox.show_info(<span class="hljs-string">&#x27;转换成功!&#x27;</span>)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        msgbox.show_error(<span class="hljs-string">&#x27;你没有选择任何文件!&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">about</span>():<br>    msgbox.show_info(message=<span class="hljs-string">&#x27;版本号:v2.0\n制作者:鱼C论坛 liuhongrun2022&#x27;</span>)<br><br><br>root = ttk.Window()<br>root.title(<span class="hljs-string">&#x27;PDF_to_Word2.0&#x27;</span>)<br>root.geometry(<span class="hljs-string">&#x27;900x100&#x27;</span>)<br><br>b1 = ttk.Button(root, text=<span class="hljs-string">&quot;pdf批量转word&quot;</span>, bootstyle=<span class="hljs-string">&#x27;info-outline&#x27;</span>, command=pdf_to_words)<br>b1.pack(side=LEFT, padx=<span class="hljs-number">5</span>, pady=<span class="hljs-number">5</span>, fill=BOTH)<br><br>b2 = ttk.Button(root, text=<span class="hljs-string">&#x27;pdf单文件转word&#x27;</span>, bootstyle=<span class="hljs-string">&#x27;warning-outline&#x27;</span>, command=pdf_to_word)<br>b2.pack(side=LEFT, padx=<span class="hljs-number">5</span>, pady=<span class="hljs-number">5</span>, fill=BOTH)<br><br>b5 = ttk.Button(root, text=<span class="hljs-string">&#x27;word转pdf&#x27;</span>,bootstyle=<span class="hljs-string">&#x27;info-outline&#x27;</span>, command=word_to_pdf)<br>b5.pack(side=LEFT, padx=<span class="hljs-number">5</span>, pady=<span class="hljs-number">5</span>, fill=BOTH)<br><br>b3 = ttk.Button(root, text=<span class="hljs-string">&#x27;关于&#x27;</span>, bootstyle=<span class="hljs-string">&#x27;success-outline&#x27;</span>, command=about)<br>b3.pack(side=LEFT, padx=<span class="hljs-number">5</span>, pady=<span class="hljs-number">5</span>, fill=BOTH)<br><br>b4 = ttk.Button(root, text=<span class="hljs-string">&#x27;退出&#x27;</span>,bootstyle=<span class="hljs-string">&#x27;danger-outline&#x27;</span>, command=exit)<br>b4.pack(side=LEFT, padx=<span class="hljs-number">5</span>, pady=<span class="hljs-number">5</span>, fill=BOTH)<br><br>l = ttk.Label(root, bootstyle=<span class="hljs-string">&#x27;inverse-warning&#x27;</span>, text=<span class="hljs-string">&#x27;转换中出现&quot;未响应&quot;为正常现象。&#x27;</span>)<br>l.pack(side=LEFT, padx=<span class="hljs-number">5</span>, pady=<span class="hljs-number">5</span>, fill=BOTH)<br>l.configure(font=(<span class="hljs-string">&#x27;微软雅黑 Light&#x27;</span>,<span class="hljs-number">9</span>))<br><br>root.mainloop()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>自我介绍</title>
    <link href="/2022/11/14/%E8%87%AA%E6%88%91%E4%BB%8B%E7%BB%8D/"/>
    <url>/2022/11/14/%E8%87%AA%E6%88%91%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<p>一个小学生</p><p>会Python</p><p>我的邮件地址 <a href="mailto:liuhongrun2022@outlook.com">liuhongrun2022@outlook.com</a></p><p><a href="https://fishc.com.cn/space-uid-1292597.html">鱼C</a></p><p><a href="https://space.bilibili.com/1635131549">通过Bilibili联系我</a></p>]]></content>
    
    
    <categories>
      
      <category>闲聊</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
